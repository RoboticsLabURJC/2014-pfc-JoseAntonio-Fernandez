%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Plantilla de memoria en LaTeX para la ETSIT - Universidad Rey Juan Carlos
%%
%% Por Gregorio Robles <grex arroba gsyc.urjc.es>
%%     Grupo de Sistemás y Comunicaciones
%%     Escuela T\'ecnica Superior de Ingenieros de Telecomunicaci\'on
%%     Universidad Rey Juan Carlos
%% (muchas ideas tomadas de Internet, colegas del GSyC, antiguos alumnos...
%%  etc. Muchas gracias a todos)
%%
%% La \'ultima versi\'on de esta plantilla est\'a siempre disponible en:
%%     https://github.com/gregoriorobles/plantilla-memoria
%%
%% Para obtener PDF, ejecuta en la shell:
%%   make
%% (las im\'agenes deben ir en PNG o JPG)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[a4paper, 12pt]{book}
\usepackage[T1]{fontenc}

\usepackage[a4paper, left=2.5cm, right=2.5cm, top=3cm, bottom=3cm]{geometry}
\usepackage{times}
\usepackage[latin1]{inputenc}
\usepackage[spanish]{babel} % Comenta esta l\'inea si tu memoria es en ingl\'es
\usepackage{url}
\usepackage{nicefrac}
%\usepackage[dvipdfm]{graphicx}
\usepackage{graphicx}
\usepackage{float}  %% H para posicionar figuras
\usepackage[nottoc, notlot, notlof, notindex]{tocbibind} %% Opciones de \'indice
\usepackage{latexsym}  %% Logo LaTeX
\usepackage{eurosym}
\usepackage{subfig}

\title{Robótica aérea con aviones}
\author{José Antonio Fernández Casillas}

\renewcommand{\baselinestretch}{1.5}  %% Interlineado

\begin{document}

\renewcommand{\refname}{Bibliograf\'ia}  %% Renombrando
\renewcommand{\appendixname}{Ap\'endice}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PORTADA

\begin{titlepage}
\begin{center}
\begin{tabular}[c]{c c}
%\includegraphics[bb=0 0 194 352, scale=0.25]{logo} &
\includegraphics[scale=0.25]{img/logo_vect.png} &
\begin{tabular}[b]{l}
\Huge
\textsf{UNIVERSIDAD} \\
\Huge
\textsf{REY JUAN CARLOS} \\
\end{tabular}
\\
\end{tabular}

\vspace{3cm}

\Large
INGENIERÍA TÉCNICA INFORMÁTICA EN SISTEMAS

\vspace{0.4cm}

\large
Curso Acad\'emico 2011/2017

\vspace{0.8cm}

Proyecto Fin de Carrera

\vspace{2.5cm}

\LARGE
ROBÓTICA AÉREA CON AVIONES

\vspace{4cm}

\large
Autor : José Antonio Fernández Casillas \\
Tutor : José María Cañas Plaza
\end{center}
\end{titlepage}

\newpage
\mbox{}
\thispagestyle{empty} % para que no se numere esta pagina


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Para firmar
\clearpage
\pagenumbering{gobble}
\chapter*{}

\vspace{-4cm}
\begin{center}
\LARGE
\textbf{Proyecto Fin de Carrera}

\vspace{1cm}
\large
Robótica aérea con aviones

\vspace{1cm}
\large
\textbf{Autor :} José Antonio Fernández Casillas
\textbf{Tutor :} José María Cañas Plaza

\end{center}

\vspace{1cm}
La defensa del presente Proyecto Fin de Carrera se realiz\'o el d\'ia \qquad$\;\,$ de \qquad\qquad\qquad\qquad \newline de 20XX, siendo calificada por el siguiente tribunal:


\vspace{0.5cm}
\textbf{Presidente:}

\vspace{1.2cm}
\textbf{Secretario:}

\vspace{1.2cm}
\textbf{Vocal:}


\vspace{1.2cm}
y habiendo obtenido la siguiente calificaci\'on:

\vspace{1cm}
\textbf{Calificaci\'on:}


\vspace{1cm}
\begin{flushright}
Fuenlabrada, a \qquad$\;\,$ de \qquad\qquad\qquad\qquad de 20XX
\end{flushright}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Dedicatoria

\chapter*{}
\pagenumbering{Roman} % para comenzar la numeracion de paginas en numeros romanos
\begin{flushright}
\textit{Dedicado a \\
mi familia / mi abuelo / mi abuela}
\end{flushright}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Agradecimientos

\chapter*{Agradecimientos}
%\addcontentsline{toc}{chapter}{Agradecimientos} % si queremos que aparezca en el \'indice
\markboth{AGRADECIMIENTOS}{AGRADECIMIENTOS} % encabezado 

Aqu\'i vienen los agradecimientos\ldots Aunque est\'a bien acordarse de la pareja,
no hay que olvidarse de dar las gracias a tu madre, que aunque a veces no lo 
parezca disfrutar\'a tanto de tus logros como t\'u\ldots Adem\'as, la pareja quiz\'as
no sea para siempre, pero tu madre s\'i.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Resumen

\chapter*{Resumen}
%\addcontentsline{toc}{chapter}{Resumen} % si queremos que aparezca en el \'indice
\markboth{RESUMEN}{RESUMEN} % encabezado

Aqu\'i viene un resumen del proyecto. Ha de constar de tres o cuatro p\'arrafos,
donde se presente de manera clara y concisa de qu\'e va el proyecto. Han
de quedar respondidas las siguientes preguntas:

\begin{itemize}
  \item ¿De qu\'e va este proyecto? ¿Cu\'al es su objetivo principal?
  \item ¿C\'omo se ha realizado? ¿Qu\'e tecnolog\'ias est\'an involucradas?
  \item ¿En qu\'e contexto se ha realizado el proyecto? ¿Es un proyecto
dentro de un marco general?
\end{itemize}

Lo mejor es escribir el resumen al final.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Resumen en ingl\'es

\chapter*{Summary}
%\addcontentsline{toc}{chapter}{Summary} % si queremos que aparezca en el \'indice
\markboth{SUMMARY}{SUMMARY} % encabezado

Here comes a translation of the ``Resumen'' into English. Please, double check
it for correct grammar and spelling. As it is the translation of the ``Resumen'',
which is supposed to be written at the end, this as well should be filled out
just before submitting.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \'iNDICES %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Las buenas noticias es que los \'indices se generan autom\'aticamente.
% Lo \'unico que tienes que hacer es elegir cu\'ales quieren que se generen,
% y comentar/descomentar esa instrucci\'on de LaTeX.

%%%% \'indice de contenidos
\tableofcontents 
%%%% \'indice de figuras
\cleardoublepage
%\addcontentsline{toc}{chapter}{Lista de figuras} % para que aparezca en el indice de contenidos
\listoffigures % indice de figuras
%%%% \'indice de tablas
%\cleardoublepage
%\addcontentsline{toc}{chapter}{Lista de tablas} % para que aparezca en el indice de contenidos
%\listoftables % indice de tablas


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INTRODUCCI\'oN %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cleardoublepage
\chapter{Introducci\'on}
\label{sec:intro} % etiqueta para poder referenciar luego en el texto con ~\ref{sec:intro}
\pagenumbering{arabic} % para empezar la numeraci\'on de p\'agina con n\'umeros

Los UAV o Drones se han popularizado en los \'ultimos años hasta es punto de formar parte de nuestro d\'ia a d\'ia con aplicaciones en muchos ambitos de nuestra vida. 

Si bien se est\'an utilizando ya de forma habitual en sectores como el cine o la ingenier\'ia civil, a\'un se est\'an explorando muchas de las posibles utilidades que estos robots pueden llegar a ofrecer.

El objetivo de este trabajo final es poner en valor y asentar el uso de un tipo de UAV que no est\'a hoy muy representado en el \'ambito civil y que aventaja en varios aspectos al más popularizado quadrac\'optero, se trata del avi\'on.

\section{Rob\'otica A\'erea}
\label{sec:robotica_aerea}

Los or\'igenes de la rob\'otica aerea tienen origen militar y su avance ha estado intr\'insecamente ligado a este \'ambito durante todo el siglo XX.

Se consideran el origen de los aviones no tripulados los experimentos llevados a cabo a principios del siglo XX durante la 1ª guerra mundial como el 'Aerial Target' desarrollado por el capit\'an A. H. Lowpara para su uso como blanco a\'ereo. Si bien eran veh\'iculos no tripulados (Unmaned Aereal Vehicles) no eran aut\'onomos y eran manejados desde tierra a trav\'es de una radio. 
No es hasta el final del siglo XX cuando bajo el escenario de la guerra de Vietnam y ante la creciente perdida de vidas de los pilotos estos veh\'iculos vuelvan de nuevo a ser objeto de desarrollo y se conviertan en veh\'iculos aut\'onomos.

Desde ese momento y hasta nuestros d\'ias se utilizan de forma habitual en el \'ambito militar en misiones de reconocimiento, bombardeos o apoyo sin arriesgar vidas humanas.

A los largo de los primeros años de este siglo debido al abaratamiento de los componentes electr\'onicos y a su minituarizaci\'on y potencia, la rob\'otica a\'erea se ha 'desmilitarizado' y esta experimentado un enorme crecimiento en el \'ambito de las aplicaciones civiles.

Hoy en d\'ia es com\'un encontrar en cualquier jugueter\'ia quadrac\'opetros radio-pilotados por poco menos de 30 euros y en tiendas especializadas podemos encontrarlos ya con el hardware y software integrados que les permiten seguir una serie de puntos de control y comportarse de forma aut\'onoma por poco más de 200 \euro.

En la actualidad el uso de AUV o drones se ha popularizado tanto que es una de las industrias en las que más ha crecido su inversi\'on, y es que seg\'un la empresa analista especializada en dones Droneii con sede en Hamburgo en un estudio sobre la inversi\'on en el sector\footnote{\url{http://www.droneii.com/drone-investment-trends-2016}} en europa se invirti\'o en en proyectos dom\'esticos en 2016 cerca de 65 millones de d\'olares increment\'andose esta cifra hasta los 314 millones si atendemos al mercado norteamericano.
Estas datos se asientan en un mercado cada vez más extendido y con una gran proyecci\'on de crecimiento,la publicaci\'on BI Intelligence\footnote{\url{http://www.businessinsider.com/the-drones-report-research-use-cases-regulations-and-issues-2016-4}} espera que las ventas de drones alcancen los 12.000 millones en 2021.

Con su uso ya ampliamente extendido en sectores como el cine, la televisi\'on, fotograf\'ia, agropecuario, forestal, ingenier\'ia civil y presencia en sectores como el de salvamento o seguridad y protecci\'on el nicho de mercado de los UAV esta lejos de su cima y se investigan dia a dia nuevos usos en sectores como el de la log\'istica o las telecomunicaciones como veremos mas adelante..

\section{Tipos de Aeronaves}
\label{sec:tipos_aeronaves}


Las aeronaves son la base sobre las que se asienta la inteligencia que permite que nuestro robot vuele de ah\'i que convenga dedicar unas l\'ineas a entender la base de las mismás y en particular las que son objeto de estudio y desarrollo en este PFC los llamados aerodinos.

Los aerodinos son aquellas aeronaves que vuelan a pesar de pesar más que el aire, son capaces de generar sustentaci\'on por sus propios medios a diferencia de los aerostatos como por ejemplo los globos aerost\'aticos.

Existen principalmente 2 tipos de aerodinos si atendemos al modo en que generan su sustentaci\'on con sus alas, de ala fija y las de ala rotatoria.

Dentro de la tipificaci\'on de ala fija tenemos aquellas aerodinos que tienes sus alas fijas al fuselaje, y que comunmente conocemos como aviones, seg\'un la OACI, un avión es un «Aerodino propulsado por motor, que debe su sustentaci\'on en vuelo principalmente a reacciones aerodin\'amicas ejercidas sobre superficies que permanecen fijas en determinadas condiciones de vuelo»
Algunos ejemplos de aerodinos de ala fija son los aeroplanos, planeadores/veleros, aladeltas, parapentes, paramotores y ultraligeros.

Este tipo de aerodinos tienen como principal ventaja que la carga de aire que necesitan en sus alas puede ser producida de muchas formás distinta (los veleros no tienen ning\'un tipo de propulsi\'on). Esta carga es variable en funci\'on de la superficie alar del mismo y permite por tanto cargas más grandes que si instal\'asemos el mismo propulsor en un ala rotatoria.
Pongamos como ejemplo el A380 de Airbus, es el avi\'on de pasajeros más grande del mundo y cuenta con 4 motores que producen un empuje de entre 70.000 y 80.000lbs, unas 32-36 toneladas de empuje cada uno generando por  tanto entre los 4 a m\'aximo rendimiento y optimás condiciones alrededor de 144 toneladas de empuje. Este avi\'on tiene un peso m\'aximo al despegue\footnote{Peso m\'aximo que es capaz de soportar un avi\'on en su maniobra de despegue}\ de entre 560 y 590 toneladas. Tenemos por tanto que necesitamos en este caso \nicefrac{1}{4} del peso total en empuje para despegar este avi\'on.
Si hici\'esemos este mismo ejercicio con un aerodino de ala rotatoria como el Boing AH-64 o Apache con un peso m\'aximo al despegue de 9,5 toneladas necesitar\'iamos que la combinaci\'on que realizan empuje y palas superase esos 9,5 toneladas para siguiera levantar del suelo.
Este tipo de aerodinos son por tanto más eficientes, r\'apidos, con mayor carga de pago, mayor alcance debido a su menor consumo y más estables.

Dentro de la tipificaci\'on de ala rotatoria tenemos aquellas aerodinos que producen su sustentaci\'on con el movimiento (rotaci\'on) de sus alas. En este tipo de aerodinos las alas, tambi\'en llamadas 'palas' en este tipo de aerodinos, giran en torno a un eje produciendo con este giro la sustentaci\'on necesaria para despegar del suelo.
Algunos ejemplos de este tipo de aerodinos son los helic\'opteros, autogiros, convertibles o los ampliamente conocidos en robotica aerea los quadrac\'opteros.
Este tipo de aerodino tiene como principal ventaja frente a los ala fija en su versatilidad a la hora de realizar las maniobras de despegue y aterrizaje que pueden realizarse de forma vertical (VTOL\footnote{Vertical take off and landing }) adem\'as de la capacidad de realizar vuelo estacionario\footnote{Mantenerse est\'aticamente en un punto elevado} que le hacen imprescindible en escenarios poco accesibles o donde nos es posible aterrizar como el rescate mar\'itimo.


\section{Aplicaciones}
\label{sec:aplicaciones}

La rob\'otica a\'erea ha experimentado un crecimiento exponencial en los \'ultimos años, se ha popularizado su uso y se ha extendido la comercializaci\'on de drones.

El sector donde m\'as r\'apida acogida ha tenido la rob\'otica a\'erea ha sido el sector audiovisual, se usa de forma habitual en cine, grabaci\'on de espect\'aculos en directo televisi\'on y fotograf\'ia. El porqu\'e de tal acogida se basa principalmente en 2 factores, los costes y la viabilidad t\'ecnica. 
Los costes de realizar una toma a\'erea en una producci\'on antes pasaban por el alquiler de un helic\'optero, dependiendo de la toma, as\'i como del material y la contrataci\'on de los medios humanos a bordo para realizarlas pod\'ia ascender a entre 4000 y 6000 euros la hora. Hoy en d\'ia basta con un pequeño dronde entre 400 y 1800 euros\footnote{Precios aproximados extra\'idos de la empresa especializada World Aviation Helicopters \url{https://www.worldaviation.es/es/servicio-drones.aspx}} por jornada e incluir\'ian en el tramo más elevado piloto y operador de c\'amara.
Como se puede constatar f\'acilmente el ahorro incurrido no es para nada desdeñable y ofrece a pequeñas productoras acceder a \'este tipo de grabaciones que de otro modo ser\'ian privativas para \'estas.
Aunque aspecto econ\'omico es especialmente importante para decantarse por el uso de este tipo de medios, existen en el mundo audiovisual trabajos que no hubiesen sido posibles hasta este momento gracias a los drones. Grabaciones en las que el riesgo humano y material que habr\'ia que asumir es tan alto que t\'an solo de \'este modo, debemos por tanto a los drones fotograf\'ias como \'esta que si bien nos se tomó como parte de ningún proyecto cinematográfico nos hace una idea de lo que la robótica aérea puede ofrecernos.
\begin{figure}[H]
  \centering
  \includegraphics[scale=0.30]{img/drone_volcan.jpg}
  \caption{Dron grabando en el interior de un crater}
  \label{fig:drone_volcan}
\end{figure}
Otro sector que ha adaptado rápidamente el uso de éstas pequeñas aeronaves es el agropecuario donde se utiliza para medir la condiciones del terreno, con el fin de recoger información sobre la hidratación, la temperatura o el ritmo de crecimiento de los cultivos. Controlan el riego e incluso esparcen los pesticidas de manera eficiente siendo un arma eficaz contra las plagas, se utilizan incluso como espantapájaros.
La aplicación de drones en este sector se remonta a 1983 cuando el Ministerio de Agricultura de Japón preocupado por el envejecimiento de su población rural encargó a Yamaha el desarrollo de una aeronave no tripulada capaz de realizar varias tareas de las anteriormente descritas a fin de atraer más gente al medio rural. En 1990 se entregaron las primeras unidades del Yamaha RMAX y actualmente el 40\% de los arrozales japoneses cuentan con un dron sobrevolándolos.

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.30]{img/Yamaha_crop_Sprayer_Drone_RMAX.jpg}
  \caption{Dron Yamaha RMAX fumigando}
  \label{fig:drone_yamaha}
\end{figure}


Son utilizados también por los servicios de rescate tras una catástrofe para evaluar los daños experimentados y ayudas a encontrar supervivientes entre los escombros. Algunos son capaces de enviar a los supervivientes paquetes de supervivencia con salvavidas, alimentos o agua mientras esperan su rescate\footnote{\url{http://www.elmundo.es/economia/2015/09/15/55f8239546163fc6598b45c3.html}}

E incluso se han empezado a utilizar por el Ministerio de Hacienda de España con fines recaudatorios, sobrevuelan las viviendas o fincas localizando edificaciones no registradas por el catastro con el fin de regularizar su situación.

El uso de drones es especialmente importante en el ámbito científico para por ejemplo tomar medidas de temperatura y CO2 en zonas peligrosas\footnote{\url{http://www.igepn.edu.ec/servicios/noticias/1395-medidas-de-temperatura-y-co2-de-las-fumarolas-muestreo-y-fotografias-con-drone}}, estudiar las nubes volcánicas\footnote{\url{https://www.nasa.gov/topics/earth/earthmonth/volcanic-plume-uavs.html}} o volar dentro de una grieta en un glaciar\footnote{\url{http://tn.com.ar/tecno/recomendados/increible-un-drone-volo-dentro-de-un-glaciar_648661}}. 

El futuro del uso de los drones se está escribiendo en este mismo momento y es que poco a poco se investigan con nuevos usos o cómo mejorar los ya actuales. 

Uno de los usos más prometedores que esta siendo investigado es el uso de drones para la logística y paquetería, Amazon estudió en 2105 la viabilidad de utilizar drones para el reparto, especialmente en zonas de difícil acceso o bien alejadas de las zonas habituales de reparto. A finales de dicho año realizó pruebas de entregas en el reino unido y desarrollo un prototipo de alrededor de 25Kg de peso. El objetivo de Amazon, entregas de menos de 3Kg en 30 minutos y una toma de contacto en la entrega de paquetes en zonas pobladas.
Esto a dado pie a las principales empresas de logística y paquetería a realizar sus propios desarrollos y constuir sus propios prototipos. 
DHL ha realizado sendas pruebas con drones de cerca de 5 Kg para la entrega de paquetes de hasta 1,2 Kg.
La empresa francesa GeoPost se ha con la empresa Atechsys, especializada en el desarrollo de sistemás autónomos para aeronaves no tripuladas, que ha dado como resultado un dron que cuenta con seis rotores eléctricos y estructura de fibra de carbono, con capacidad para llevar paquetes de un peso aproximado de hasta 2 kilos.
UPS ha realizado un experimento en tampa con un octocóptero que despegaría desde el techo de la furgoneta de reparto para entregar los paquetes en zonas rurales y ahorrar en kilometraje el dron tendía una carga de pago de unos 4,5Kg.

Otro de los estudios que más llama la atención es el de Google y Facebook que compiten en llevar internet a zonas aisladas a través de una re de drones y satélites.
Facebook presentó en su F8 en Marzo de 2015 su prototipo de dron a tal efecto, Aquila, fruto de la adquisición de la empresa especializa en robótica aérea Acenta. Este proyecto se enmarca dentro del plan internet.org y liderado Connectivity Lab\footnote{Un equipo formado por 50 expertos en aeronáutica y ciencia espacial} que pretende ofrecer internet con un coste reducido a todo aquel que no lo tenga.
 
\section{Rob\'otica a\'erea en el laboratorio de Rob\'otica de la URJC}
\label{sec:lab_robotica}

Dentro del laboratorio de rob\'otica de la Universidad Rey Juan Carlos cabe destacar los trabajos realizados para profundizar investigar y experimentar con ellos.

Trabajos como el de Alberto Mart\'inez Florido permitió controlar un AR-Drone real desde una aplicación cliente, desarrollando para ello un driver para el dron, ardrone\_server y una aplicacción cliente UAV Viewer.
El driver ardrone\_server es capaz de conectar con el AR-DRONE a través de comandos AT tanto para obtener los datos de todos sus sensores como para controlarlo y expone todo ello en interfaces JdeRobot para su interconexión con todo el software disponible en el framework.
El AR-Drone es un quadracóptero que en su versión actual cuenta con acelerómetros, giróscopos y magnetómetros en 3 ejes que determinan junto con su barómetro y un sensor de ultrasonidos la actitud del mismo, dispone además de 2 cámaras, una ventral y otra frontal y algunos modelos traen sensor GPS.
Alberto desarrolló también el software de control UAV Viewer, esta aplicación cliente es capaz de controlar con cualquier drone y mostrar de forma visual su actitud, lo que captan sus cámaras.

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.30]{img/uavviewer.png}
  \caption{Ventanas de UAV Viewer}
  \label{fig:uavviewer}
\end{figure}

Daniel Yague desarrolló un driver para poder simular el comportamiento del AD-Dronde en el simulador Gazebo, de referencia en el departamento de robótica de la universidad y contenido dentro de la suite JdeRobot. Con este desarrollo se hizo posible desarrollar, probar anticipar los problemas que puedan surgir en el vuelo del dron antes siquiera de volarlo, de esta forma es posible el desarrollo de aplicaciones de navegación complejas sin disponer de el, sin arriesgarlo e independientemente de factores externos como la climatología.
Para mostrar las posibilidades de desarrollo que se abrían desarrolló varias aplicaciones en el ar-drone simulado como un gato-ratón donde un dron teleoperado trataba de huir de otro que le seguía o una aplicación donde el dron seguía una carretera.

Jorge Cano construyó propio su dron utilizando como base un quadrac\'optero con un Intel Compute Stick (ICS) STCK1A8LFC como ordenador de abordo y una placa Pixhawnk como placa estabilizadora/piloto automático. Esta placa utiliza como protocolo de comunicación MAVLink\footnote{Micro Air Vehicle Link \url{https://en.wikipedia.org/wiki/MAVLink}} y dispone de acelerómetros, giróscopos y magnetómetros para determinar la actitud.
Además de la construcción del drone Jorge desarrolló el driver MAVLinkServer donde apoyándose en MAVProxy adaptó los comandos MAVLink a interfaces JdeRobot permitiendo acceder a la actitud y controlar el drone con comandos tipo GotoXY enviados a través del interfaz Pose3D\footnote{Ver capítulo 3 Arquitectura utilizada}

\begin{figure}[h]
\centering
  \subfloat[Intel]{
   \label{f:Ordenador de abordo}
    \includegraphics[width=0.3\textwidth]{img/Compuandcaminstall.JPG}}
  \subfloat[camaras]{
   \label{f:Cámaras de abordo}
    \includegraphics[width=0.535\textwidth]{img/FPVcamara.jpg}}
 \label{f:drone_cano}
\end{figure}

En la actualidad se estan desarrollando nuevos trabajos sobre este tipo de placas estabilizadoras que tiene como software base ArduCopter/Ardupilot o son compatibles.

Diego Jimenez trabaja en controlar un Solo Drone de la empresa 3DR\footnote{Empresa norteamericana con sede en California especializada en rob\'otica a\'erea. Se sit\'ua en 2017 como la 3ª empresa del sector} mediante el interfaz de velocidades CMDVel\footnote{Ver capítulo 3 Arquitectura utilizada}, este quadracótero tiene como placa de control una Pixhawnk como la utilizada por Jorge Vela en el dron que se construyó y utiliza también comamdos MAVLink.

Jorge Vela se encuentra desarrollando como realizar la maniobra de aterrizaje de forma autom\'atica al localizar un patrón o baliza localizado visión, como drone estan utilizando un Solo Drone con una Intel Stick como ordenador de abordo.

\chapter{Objetivos}
\label{sec:objetivos}

[PRELIMINAR SOLO IDEAS]
Los objetivos de este PFC son arrojar luz sobre el uso de drones de ala fija poniendo en valor \'estos en situaciones donde la carga de pago, la autonom\'ia, velocidad o consumo desaconsejan el uso de los más extendidos quadrac\'opteros.

Para \'esto hemos adaptado un avi\'on de radio-control comercial añadi\'endole toda la avi\'onica necesaria para que puede operar como drone. Hemos desarrollado un driver para JdeRobot del interfaz MAVLink que nos permite recoger actitud, velocidades lineales y angulares, altura, posici\'on y otros par\'ametros como la bater\'ia restante. Nos permite tambi\'en la actuaci\'on con el seguimiento de misiones que no s\'olo incluyen el paso por ciertos puntos de control o waypoints sino que tambi\'en soporta las maniobras de despegue y aterrizaje en drones de ala fija.
Hemos desarrollado tambi\'en un software de control que da soporte a este tipo de actuaci\'on de más alto nivel, las misiones.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INFRAESTRUCTURA %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cleardoublepage
\chapter{Infraestructura utilizada}
\label{chap:infraestructura_utilizada}

\section{Hardware}
\label{sec:hardware}

Este PFC se apoya principalmente en 2 piezas hardware:


\begin{itemize}
\item El avi\'on a radio-control. Para este desarrollo hemos elegido el avi\'on Bix3 distribuido por la empresa china \url{www.hobbyking.com}, hemos elegido este modelo por ser un avi\'on muy estable debido principalmente a sus cualidades como velero y su alta superficie alar. Otro aspecto importante de la constrcción del avión es que el propulsor no se encuentra en el frontal del avión lo que nos permitirá aprovechar al máximo esa zona pudiendo poner incluso una cámara frontal.

\begin{figure}[h]
\centering
  \subfloat[Bix3]{
   \label{f:Bix3}
    \includegraphics[width=0.339\textwidth]{img/bix_general.jpg}}
  \subfloat[Vista de cerca]{
   \label{f:Vista de cerca}
    \includegraphics[width=0.339\textwidth]{img/bix_prof.jpg}}
  \subfloat[Bix3 en vuelo]{
   \label{f:Bix en vuelo}
    \includegraphics[width=0.3\textwidth]{img/bix_vuelo.png}}
 \label{f:drone_cano}
\end{figure}

Para poder cargar con el equipo necesario nos ha sido necesario cambiar el motor, el variador y las bater\'ias de serie por otras de mayor rendimiento que nos permitan volar con tanta carga de pago.

\item Una raspberry PI3 que es nuestro ordenador de abordo y en el que instalaremos la infraestructura necesaria para que podamos dotarle de inteligencia. Hemos elegido \'este dispositivo debido al compromiso peso/potencia que nos otorga as\'i como porque se trata de un hardware muy asequible  y extendido. Conectado a esta PI3 irá una PiCam que nos permitira ver lo que el avión vea.
\end{itemize} 

\section{Placa estabilizadora}
\label{sec:estabilizadora}

El estabilizador/piloto autom\'atico, para este desarrollo hemos optado por un Ardupilot Mega\footnote{\url{http://www.ardupilot.co.uk/}}. Este dispositivo tiene como base una placa Arduino Mega a la que se le han incoorporado, gir\'oscopos y acerel\'ometros en 3 ejes para su estabilizaci\'on y que trae de serie un receptor GPS con br\'ujula. El kit que adquirimos incluye también también 
Esta placa ataca directamente sobre los actuadores del avi\'on (los servos y el motor) a trav\'es de señales PWM. 

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.50]{img/ardupilot.jpg}
  \caption{Placa estabilizadora ardupilot}
  \label{fig:ardupilot}
\end{figure}

Esta placa ha de flashearse con un firmware en función del tipo de aeronave que utilicemos como base, Arducoopter para alas rotatorias o Ardupilot para alas fijas.

Esta y otras placas similares como PixHawnk ofrecen un interfaz que se apoya en comandos llamado MAVLink. A trav\'es de comandos MAVLink se puede acceder a los sensores, a los que incoorpora la placa o a los que le añadamos a la misma como el GPS o sensores de velocidad del aire. A trav\'es de estos comandos se le puede tambi\'en enviar ordenes al piloto autom\'atico quien las ejecutar\'a más adelante trataremos el protocolo MAVLink en profundidad. Cabe sin embargo destacar ya en este punto no sólo que algunos de los comando que mandemos tendran distinto comportamiento en la placa en funcion del firmware escogido sino que hay set de comandos que no pueden ser utilizados en uno o en otro.


\section{JdeRobot}
\label{sec:jderobot}

JdeRobot es un framework desarrollado por el laboratorio de robótica de la Universidad Rey Juan Carlos, para el desarrollo de aplicaciones de robótica. Su última realease la 5.5 se liberó el 15 de Marzo de 2017 pudiendo ver los detalles de ésta en el github oficial\footnote{\url{https://github.com/JdeRobot/JdeRobot/wiki/JdeRobot-5.5.0}}.
JdeRobot se compone de interfaces, drivers, utilidades y aplicaciones para el desarrollo de cualquier proyecto de robótica, se apoya en estos interfaces, algunos de ellos los veremos en profundidad a continuación, para interconectar entre sí todos los aplicativos del mismo y en Zeroc ICE para la comunicación entre ellos.
Algunos de los driver mas importantes que contiene serían:
\begin{enumerate}
\item Cameraserver. Se trata de un driver para enviar imágenes y video a través del interfaz camera
\item Gazeboserver. Driver desarrollado para conectar la herramienta de simulación Gazebo con JdeRobot y así poder simular los desarrollos.
\item MAVLinkServer. Desarrollado para intercomunicar JdeRobot con placas que utilicen el protocolo de comunicación MAVLink.
\item Ardrone\_server. Driver que conecta el Parrot Ar-Drone a JdeRobot. Este driver escrito en c++ transforma el set de comandos AT del done en interfaces y viceversa, implementa los interfaces camera, cmdvel, navdata, extra y pose3D y permite acceder a la actitud del drone así como a sus 2 cámaras. Sirve también datos como el nivel de la batería y permite grabar vídeo o tomar fotos.
\end{enumerate}
Algunas de las aplicaciones desarrolladas más importantes serían:
\begin{enumerate}
\item Cameraview. Se trata de una aplicación desarrollada en c++ capaz de recibir vídeo a través del interfaz camera.
\item UAV viewer. Aplicación desarrollada como ground control de robots aéreos. Esta aplicación permite teleoperar cualquier tipo de robot aéreo y ofrece de forma visualmente atractiva datos como la actitud, velocidades lineales y angulares, ofrece también la posibilidad de visualizar videos servidos por el interfaz camera.
\end{enumerate}
\subsection{Interfaces}

JdeRobot expone más de 30 interfaces pero en este cap\'itulo explicaremos los que durante nuestro desarrollo hemos implementado:
\begin{itemize}
\item Pose3D. Utilizado para recoger los datos de actitud y la posici\'on de la aeronave.
\begin{verbatim}
Pose3DData
  {
	float x;  /* x coord */
	float y;  /* y coord */
	float z;  /* z coord */
  	float h;  /* */
	float q0; /* qw */
	float q1; /* qx */
	float q2; /* qy */
	float q3; /* qz */
  };
\end{verbatim}
\item Camera. Utilizado para servir im\'agenes.

\begin{verbatim}
  class CameraDescription
  {
    string name;
    string shortDescription;
    string streamingUri;
    float fdistx;
    float fdisty;
    float u0;
    float v0;
    float skew;
    float posx;
    float posy;
    float posz;
    float foax;
    float foay;
    float foaz;
    float roll;
  };

\end{verbatim}
\item NavData. Utilizado para servir datos secundarios de actuaci\'on como velocidades lineales o angulares o el estado de la bater\'ia.
\begin{verbatim}
class NavdataData 
{
 int vehicle; //0-> ArDrone1, 1-> ArDrone2
 int state; // landed, flying,...
 float batteryPercent; //The remaing charge of baterry %
		
 //Magnetometer Ardron2.0
 int magX;
 int magY;
 int magZ;
		
 int pressure; //Barometer Ardron2.0
 int temp;     //Temperature sensor Ardron2.0
 float windSpeed; //Estimated wind speed Ardron2.0		
		
 float windAngle;
 float windCompAngle;
 
 float rotX; //rotation about the X axis
 float rotY; //rotation about the Y axis		
 float rotZ; //rotation about the Z axis
 
 int altd; //Estimated altitude (mm) 

 //linear velocities (mm/sec)
 float vx;
 float vy;
 float vz;
		
 //linear accelerations (unit: g) ¿Ardron2.0?
 float ax;
 float ay;
 float az;

 //Tags in Vision Detectoion
 //Should be unsigned
 int tagsCount;
 arrayInt tagsType;
 arrayInt tagsXc;
 arrayInt tagsYc;
 arrayInt tagsWidth;
 arrayInt tagsHeight;
 arrayFloat tagsOrientation;
 arrayFloat tagsDistance;

 float tm; //time stamp
};
\end{verbatim}
\item Extra. Utilizado principalmente para las \'ordenes de despegue y aterrizaje.
\begin{verbatim}
    void land() - land drone. 
    void takeoff() - takeoff drone. 
    void reset() 
    void recordOnUsb(bool record) 
    void ledAnimation(int type,float duration, float req) 
    void flightAnimation(int type, float duration) 
    void flatTrim() 
    void toggleCam() - switch camera. 
\end{verbatim}

\end{itemize}


\section{MAVLink}
label{sec:mavlink}

MAVLink siglas de Micro Air Vehicle Link es un protocolo de comunicación desarrollado para comunicar las placas estabilizadoras con piloto automático a los GCS o Ground control station, las aplicaciones desde las que se podía enviar misiones y seguir el cumplimiento de las mismas desde tierra.
MAVLink se publicó en 2009 por Lorenz Meier, publicado bajo licencia LGPL aspira a convertirse en el protocolo standard en robótica aérea y se ha probado su funcionamiento en PX4, PIXHAWK, APM\footnote{Ardupilot Mega} y Parrot AR.Drone.

Un ejemplo de comando MAVLink ser\'ia:
{\small
\begin{verbatim}
type GpsStatus struct {
    SatellitesVisible  uint8      Némero de satélites visibles
    SatellitePrn       [20]uint8  Id Global de cada satélite
    SatelliteUsed      [20]uint8  Lista con el uso de cada satélite
    SatelliteElevation [20]uint8  Elevación, nos da el ángulo sobre el horizonte.
    SatelliteAzimuth   [20]uint8  Dirección del satélite, 0: 0 grados, 255: 360 grados.
    SatelliteSnr       [20]uint8  Señal/ruido de cada uno de los satélites
}
\end{verbatim}}
Este mensaje trae la informaci\'on del enlace actual con el GPS y se env\'ia peri\'odicamente en ciclos que decidimos en par\'ametros de conexi\'on con el dispositivo.
Otro par\'ametro, esta vez vinculado a la actuaci\'on ser\'ia:
{\small
\begin{verbatim}
type MissionItem struct {
    Param1          float32    parámetro variable en función del comando.
    Param2          float32    parámetro variable en función del comando.
    Param3          float32    parámetro variable en función del comando.
    Param4          float32    parámetro variable en función del comando.
    X               float32    latitud
    Y               float32    longitud
    Z               float32    altitud
    Seq             uint16     Número del item en la misión
    Command         uint16     Tipo de comando de navegación.
    TargetSystem    uint8      ID del sistema
    TargetComponent uint8      
    Frame           uint8      Sistema de coordenadas que se utiliza.
    Current         uint8      Misión actual no:0, si:1
    Autocontinue    uint8      Autocontinuar al siguiente objeto de misión.
}
\end{verbatim}}


\section{Python y PyQt5}
\label{sec:python}

Python es un lenguaje de programación interpretado y multiplataforma que nació en los años 80 en los país bajos con idea de hacer más legible el código.
El lenguaje de programación que inicialmente se utilizaba principalmente para scripting, ha sabido crecer con los años y con la publicación de Python3 en 2009 ha recibido el impulso que necesitaba para ser hoy en día el 5º leguaje mas utilizado por encima de PHP, .NET y Javascript que baja hasta el 8º puesto según TIOBE en un estudio de Abril de 2017.

El porqué de utlizar Python, muy sencillo mantiene el carácter multiplataforma de JdeRobot, su código es simple y legible y trabaja muy bien con dependencias muy utilizadas en robótica como OpenCV.

Para nuestro desarrollo hemos utilizado PyQt5 para desarrollar el interfaz gráfico. PyQt5 es un binding de Qt5 en forma de librería python que nos permite acceder a toda la funcionalidad de Qt5. Qt, propiedad de Nokia, es un conjunto de librerías escritas en C++ para interfaces gráficas.


\section{Mapas y Geo-referenciación}
\label{sec:mapas}

En nuestro desarrollo hemos tenido que trabajar con mapas geo-referenciados. Estos mapas, que tanto se han popularizado gracias a Google, son una herramienta imprescindible en robótica aérea si se quiere trabajar con largas distancias.

Un mapa geo-referenciado es aquel en el que conocemos o podemos calcular la posición en el planeta que representa cada pixel del mismo.

La forma mas común de obtener estos mapas geo-referenciado es a través de WMS, siglas de Web Map Service. Un WMS nos es mas que un servicio web que recibe como entrada unas coordenadas y una serie de parámetros y devuelve una imagen encuadrada en lo datos enviados.
En nuestro desarrollo hemos utilizado 2 WMS el del IGN\footnote{Instrituto Geográfico Nacional de españa} y el de Google, a continuación vamos a desgranar un WMS, el de PMOA del IGN.

El WMS PNOA requiere como entrada 4 atributos principales:
\begin{enumerate}
\item La posición GPS.
\item Bounding Box. El Bounding box son 2 puntos que corresponden con la posición GPS que queremos que sea el extremo inferior izquierdo de nuestra imagen y con el punto superior derecho de la misma.
\item Datum. El datum es el sistema de referencia o proyección de la tierra a utilizar. En el caso de IGN pese a que soporta varias utilizamos WGS84 que es el estandar.
\item Tamaño de la imagen, el tamaño que queremos que tenga la imagen obtenida.
\end{enumerate}
El resultado un mapa del que conocemos el punto central, y los extremos inferior izquierdo y superior derecho y los pixeles que tiene a lo ancho y alto del mismo, un mapa geo-referenciado.



\section{SITL}
\label{sec:SITL}

SITL siglas de Software in the loop es un simulador que te permite a cualquier programa que envíe o reciba comandos MAVLink ejecutar pruebas sin necesidad de tener ninguna placa estabilizadora y evitando la pérdida de la aeronave en caso de error del mismo.
SITL se conecta con JSBSim, un simulador de vuelo de software libre para ejecutar el aspecto físico de la simulación y con MAVProxy para el envío de commandos y seguimento de misiones.
Se trata de una compilación en C++ de ardupilot y se podría asemejar a nuestro gazeboserver.
SITL puede conectarse también con Gazebo o a FlightGear para hacer mas completa su simulación mostrando el vuelo en un entorno desarrollado para pruebas con elementos del mundo real.
\begin{figure}[H]
  \centering
  \includegraphics[scale=0.50]{img/SITL.jpg}
  \caption{Arquitectura de SITL}
  \label{fig:sitl}
\end{figure}

\cleardoublepage
\chapter{Infraestructura Desarrollada}


Descripci\'on de las tecnolog\'ias que utilizas en tu trabajo. Con dos o tres p\'arrafos por cada tecnolog\'ia, vale.


Puedes citar libros, como el de Bonabeau et al. sobre procesos estigm\'ergicos~\cite{bonabeau:_swarm}. % Nota que el ~ añade un espacio en blanco, pero no deja que exista un salto de l\'inea. Imprescindible ponerlo para las citas.

Tambi\'en existe la posibilidad de poner notas al pie de p\'agina, por ejemplo, 
una para indicarte que visite la p\'agina de 
LibreSoft\footnote{\url{http://www.libresoft.es}}.

\section{Secci\'on 1} 
\label{sec:seccion1}




\cleardoublepage
\chapter{AUV Commander}

\section{Arquitectura general} 
\label{sec:arquitectura}

figura~\ref{fig:arquitectura}.

\begin{figure}
  \centering
  \includegraphics[width=9cm, keepaspectratio]{img/arquitectura}
  \caption{Estructura del parser b\'asico}
  \label{fig:arquitectura}
\end{figure}




\cleardoublepage
\chapter{Experimentos}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CONCLUSIONES %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cleardoublepage
\chapter{Conclusiones}
\label{chap:conclusiones}


\section{Consecuci\'on de objetivos}
\label{sec:consecucion-objetivos}

Esta secci\'on es la secci\'on espejo de las dos primeras del cap\'itulo de objetivos,
donde se planteaba el objetivo general y se elaboraban los espec\'ificos.

Es aqu\'i donde hay que debatir qu\'e se ha conseguido y qu\'e no. Cuando algo no
se ha conseguido, se ha de justificar, en t\'erminos de qu\'e problemás se han
encontrado y qu\'e medidas se han tomado para mitigar esos problemás.


\section{Aplicaci\'on de lo aprendido}
\label{sec:aplicacion}

Aqu\'i viene lo que has aprendido durante el Grado/M\'aster y que has aplicado
en el TFG/TFM. Una buena idea es poner las asignaturas m\'as relacionadas y
comentar en un p\'arrafo los conocimientos y habilidades puestos en pr\'actica.

\begin{enumerate}
  \item a
  \item b
\end{enumerate}


\section{Lecciones aprendidas}
\label{sec:lecciones_aprendidas}

Aqu\'i viene lo que has aprendido en el Trabajo Fin de Grado/M\'aster.

\begin{enumerate}
  \item a
  \item b
\end{enumerate}


\section{Trabajos futuros}
\label{sec:trabajos_futuros}

Ning\'un software se termina, as\'i que aqu\'i vienen ideas y funcionalidades
que estar\'ia bien tener implementadas en el futuro.

Es un apartado que sirve para dar ideas de cara a futuros TFGs/TFMs.


\section{Valoraci\'on personal}
\label{sec:valoracion}

Finalmente (y de manera opcional), hay gente que se anima a dar su punto de
vista sobre el proyecto, lo que ha aprendido, lo que le gustar\'ia haber aprendido,
las tecnolog\'ias utilizadas y dem\'as.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% AP\'eNDICE(S) %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cleardoublepage
\appendix
\chapter{Manual de usuario}
\label{app:manual}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BIBLIOGRAFIA %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cleardoublepage

% Las siguientes dos instrucciones es todo lo que necesitas
% para incluir las citas en la memoria
\bibliographystyle{abbrv}
\bibliography{memoria}  % memoria.bib es el nombre del fichero que contiene
% las referencias bibliogr\'aficas. Abre ese fichero y mira el formato que tiene,
% que se conoce como BibTeX. Hay muchos sitios que exportan referencias en
% formato BibTeX. Prueba a buscar en http://scholar.google.com por referencias
% y ver\'as que lo puedes hacer de manera sencilla.
% M\'as informaci\'on: 
% http://texblog.org/2014/04/22/using-google-scholar-to-download-bibtex-citations/

\end{document}
